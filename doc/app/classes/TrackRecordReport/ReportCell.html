<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: TrackRecordReport::ReportCell</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">TrackRecordReport::ReportCell</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/track_record_report_rb.html">
                lib/track_record_report.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ReportElementaryCalculator.html">
                ReportElementaryCalculator
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Store information about a specific task over a column&#8216;s date range.
</p>
<p>
The object does not store the task or range data since this would be
redundant across potentially numerous instances leading to significant RAM
wastage. Instead:
</p>
<ul>
<li>The <a href="ReportCell.html">ReportCell</a> objects are stored in a <a
href="ReportRow.html">ReportRow</a> &quot;cells&quot; array. The array
indices correspond directly to array indices of the <a
href="Report.html">Report</a>&#8216;s &quot;ranges&quot; array, compiled as
the first row of the report gets built.

</li>
<li>The ReportRows&#8217; &quot;task&quot; property gives the task object for
that row.

</li>
</ul>
<p>
So - to find task and range, you need to know the row index of the <a
href="ReportRow.html">ReportRow</a> and the column index of the <a
href="ReportCell.html">ReportCell</a> this contains.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000224">add_user_data</a>&nbsp;&nbsp;
      <a href="#M000225">calculate!</a>&nbsp;&nbsp;
      <a href="#M000223">new</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">user_data</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
<a href="../User.html">User</a> breakdown for this cell

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000223" class="method-detail">
        <a name="M000223"></a>

        <div class="method-heading">
          <a href="#M000223" class="method-signature">
          <span class="method-name">new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000223-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000223-source">
<pre>
      <span class="ruby-comment cmt"># File lib/track_record_report.rb, line 1063</span>
1063:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>()
1064:       <span class="ruby-keyword kw">super</span>()
1065:       <span class="ruby-ivar">@user_data</span> = []
1066:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000224" class="method-detail">
        <a name="M000224"></a>

        <div class="method-heading">
          <a href="#M000224" class="method-signature">
          <span class="method-name">add_user_data</span><span class="method-args">( data )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add the given <a href="ReportUserData.html">ReportUserData</a> object to
the &quot;@user_data&quot; array and add it to the internal running hourly
count.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000224-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000224-source">
<pre>
      <span class="ruby-comment cmt"># File lib/track_record_report.rb, line 1071</span>
1071:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_user_data</span>( <span class="ruby-identifier">data</span> )
1072:       <span class="ruby-ivar">@user_data</span>.<span class="ruby-identifier">push</span>( <span class="ruby-identifier">data</span> )
1073:       <span class="ruby-identifier">add!</span>( <span class="ruby-identifier">data</span> )
1074:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000225" class="method-detail">
        <a name="M000225"></a>

        <div class="method-heading">
          <a href="#M000225" class="method-signature">
          <span class="method-name">calculate!</span><span class="method-args">( range, committed, not_committed, user_ids = [] )</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pass a date range, an array of committed work packets sorted by date
descending, an array of not committed work packets sorted by date
descending and an optional user IDs array. Hours are summed for work
packets across the given range. Any work packets falling within the range
are removed from the arrays. Separate totals for each of the users in the
given array are maintained in the @user_data array.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000225-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000225-source">
<pre>
      <span class="ruby-comment cmt"># File lib/track_record_report.rb, line 1083</span>
1083:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate!</span>( <span class="ruby-identifier">range</span>, <span class="ruby-identifier">committed</span>, <span class="ruby-identifier">not_committed</span>, <span class="ruby-identifier">user_ids</span> = [] )
1084:       <span class="ruby-comment cmt"># Reset internal calculations and pre-allocate ReportUserData objects for</span>
1085:       <span class="ruby-comment cmt"># each user (if any).</span>
1086: 
1087:       <span class="ruby-identifier">reset!</span>()
1088:       <span class="ruby-ivar">@user_data</span> = []
1089: 
1090:       <span class="ruby-identifier">user_ids</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">user_index</span> <span class="ruby-operator">|</span>
1091:         <span class="ruby-ivar">@user_data</span>[ <span class="ruby-identifier">user_index</span> ]= <span class="ruby-constant">ReportUserData</span>.<span class="ruby-identifier">new</span>
1092:       <span class="ruby-keyword kw">end</span>
1093: 
1094:       <span class="ruby-comment cmt"># Start and the end of the committed packets array. For anything within</span>
1095:       <span class="ruby-comment cmt"># the given range, add the hours to the internal total and add to the</span>
1096:       <span class="ruby-comment cmt"># relevant user</span>
1097: 
1098:       <span class="ruby-ivar">@committed</span> = <span class="ruby-identifier">sum</span>(
1099:         <span class="ruby-identifier">range</span>,
1100:         <span class="ruby-identifier">committed</span>,
1101:         <span class="ruby-identifier">user_ids</span>,
1102:         <span class="ruby-identifier">:add_committed_hours</span>
1103:       )
1104: 
1105:       <span class="ruby-comment cmt"># Same again, but for not committed hours.</span>
1106: 
1107:       <span class="ruby-ivar">@not_committed</span> = <span class="ruby-identifier">sum</span>(
1108:         <span class="ruby-identifier">range</span>,
1109:         <span class="ruby-identifier">not_committed</span>,
1110:         <span class="ruby-identifier">user_ids</span>,
1111:         <span class="ruby-identifier">:add_not_committed_hours</span>
1112:       )
1113:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>